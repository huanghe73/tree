{"version":3,"sources":["webpack:///./examples/draggable.js","webpack:///./examples/draggable.less?150c","webpack:///./examples/util.js"],"names":["Demo","state","gData","autoExpandParent","expandedKeys","onDragStart","info","console","log","onDragEnter","setState","onDrop","dropKey","node","props","eventKey","dragKey","dragNode","dropPos","pos","split","dropPosition","Number","length","loop","data","key","callback","forEach","item","index","arr","children","dragObj","splice","dropToGap","ar","i","push","onExpand","arguments","map","title","React","Component","ReactDOM","render","document","getElementById","generateData","x","y","z","_loop","_level","_preKey","_tns","preKey","tns","__level","calcTotal","rec","n","isPositionPrefix","smallPos","bigPos","charAt","substr","filterParentPosition","levelObj","posLen","levelArr","Object","keys","sort","j","_i","ii","filter","p","nArr","concat","loopData","d","level","spl","str","splitLen","getFilterExpandedKeys","expandedPosArr","indexOf","filterExpandedKeys","isSibling","pos1","pop","join","getRadioSelectKeys","selectedKeys","res","pkObjArr","selPkObjArr","lenObj","getPosKey","k","pkArr","pk"],"mappings":"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","file":"examples/draggable.js","sourcesContent":["/* eslint no-console:0 */\r\nimport 'rc-tree/assets/index.less';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Tree, { TreeNode } from 'rc-tree';\r\nimport { gData } from './util';\r\nimport './draggable.less';\r\n\r\nclass Demo extends React.Component {\r\n  state = {\r\n    gData,\r\n    autoExpandParent: true,\r\n    expandedKeys: ['0-0-key', '0-0-0-key', '0-0-0-0-key'],\r\n  };\r\n  onDragStart = (info) => {\r\n    console.log('start', info);\r\n  }\r\n  onDragEnter = (info) => {\r\n    console.log('enter', info);\r\n    this.setState({\r\n      expandedKeys: info.expandedKeys,\r\n    });\r\n  }\r\n  onDrop = (info) => {\r\n    console.log('drop', info);\r\n    const dropKey = info.node.props.eventKey;\r\n    const dragKey = info.dragNode.props.eventKey;\r\n    const dropPos = info.node.props.pos.split('-');\r\n    const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\r\n    // const dragNodesKeys = info.dragNodesKeys;\r\n    const loop = (data, key, callback) => {\r\n      data.forEach((item, index, arr) => {\r\n        if (item.key === key) {\r\n          callback(item, index, arr);\r\n          return;\r\n        }\r\n        if (item.children) {\r\n          loop(item.children, key, callback);\r\n        }\r\n      });\r\n    };\r\n    const data = [...this.state.gData];\r\n    let dragObj;\r\n    loop(data, dragKey, (item, index, arr) => {\r\n      arr.splice(index, 1);\r\n      dragObj = item;\r\n    });\r\n    if (info.dropToGap) {\r\n      let ar;\r\n      let i;\r\n      loop(data, dropKey, (item, index, arr) => {\r\n        ar = arr;\r\n        i = index;\r\n      });\r\n      if (dropPosition === -1) {\r\n        ar.splice(i, 0, dragObj);\r\n      } else {\r\n        ar.splice(i + 1, 0, dragObj);\r\n      }\r\n    } else {\r\n      loop(data, dropKey, (item) => {\r\n        item.children = item.children || [];\r\n        // where to insert 示例添加到尾部，可以是随意位置\r\n        item.children.push(dragObj);\r\n      });\r\n    }\r\n    this.setState({\r\n      gData: data,\r\n    });\r\n  }\r\n  onExpand = (expandedKeys) => {\r\n    console.log('onExpand', arguments);\r\n    this.setState({\r\n      expandedKeys,\r\n      autoExpandParent: false,\r\n    });\r\n  }\r\n  render() {\r\n    const loop = data => {\r\n      return data.map((item) => {\r\n        if (item.children && item.children.length) {\r\n          return <TreeNode key={item.key} title={item.title}>{loop(item.children)}</TreeNode>;\r\n        }\r\n        return <TreeNode key={item.key} title={item.title} />;\r\n      });\r\n    };\r\n    return (<div className=\"draggable-demo\">\r\n      <h2>draggable</h2>\r\n      <p>drag a node into another node</p>\r\n      <div className=\"draggable-container\">\r\n        <Tree\r\n          expandedKeys={this.state.expandedKeys}\r\n          onExpand={this.onExpand} autoExpandParent={this.state.autoExpandParent}\r\n          draggable\r\n          onDragStart={this.onDragStart}\r\n          onDragEnter={this.onDragEnter}\r\n          onDrop={this.onDrop}\r\n        >\r\n          {loop(this.state.gData)}\r\n        </Tree>\r\n      </div>\r\n    </div>);\r\n  }\r\n}\r\n\r\nReactDOM.render(<Demo />, document.getElementById('__react-content'));\r\n\n\n\n// WEBPACK FOOTER //\n// ./examples/draggable.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./examples/draggable.less\n// module id = 215\n// module chunks = 3","/* eslint no-loop-func: 0 */\r\n/* eslint no-console:0 */\r\n\r\nexport function generateData(x = 3, y = 2, z = 1, gData = []) {\r\n  // x：每一级下的节点总数。y：每级节点里有y个节点、存在子节点。z：树的level层级数（0表示一级）\r\n  function _loop(_level, _preKey, _tns) {\r\n    const preKey = _preKey || '0';\r\n    const tns = _tns || gData;\r\n\r\n    const children = [];\r\n    for (let i = 0; i < x; i++) {\r\n      const key = `${preKey}-${i}`;\r\n      tns.push({ title: `${key}-label`, key: `${key}-key` });\r\n      if (i < y) {\r\n        children.push(key);\r\n      }\r\n    }\r\n    if (_level < 0) {\r\n      return tns;\r\n    }\r\n    const __level = _level - 1;\r\n    children.forEach((key, index) => {\r\n      tns[index].children = [];\r\n      return _loop(__level, key, tns[index].children);\r\n    });\r\n\r\n    return null;\r\n  }\r\n  _loop(z);\r\n  return gData;\r\n}\r\nexport function calcTotal(x = 3, y = 2, z = 1) {\r\n  /* eslint no-param-reassign:0 */\r\n  const rec = (n) => n >= 0 ? x * (y ** n--) + rec(n) : 0;\r\n  return rec(z + 1);\r\n}\r\nconsole.log('总节点数（单个tree）：', calcTotal());\r\n// 性能测试：总节点数超过 2000（z要小）明显感觉慢。z 变大时，递归多，会卡死。\r\n\r\nexport const gData = generateData();\r\n\r\nfunction isPositionPrefix(smallPos, bigPos) {\r\n  if (bigPos.length < smallPos.length) {\r\n    return false;\r\n  }\r\n  // attention: \"0-0-1\" \"0-0-10\"\r\n  if ((bigPos.length > smallPos.length) && (bigPos.charAt(smallPos.length) !== '-')) {\r\n    return false;\r\n  }\r\n  return bigPos.substr(0, smallPos.length) === smallPos;\r\n}\r\n// console.log(isPositionPrefix(\"0-1\", \"0-10-1\"));\r\n\r\n\r\n// arr.length === 628, use time: ~20ms\r\nexport function filterParentPosition(arr) {\r\n  const levelObj = {};\r\n  arr.forEach((item) => {\r\n    const posLen = item.split('-').length;\r\n    if (!levelObj[posLen]) {\r\n      levelObj[posLen] = [];\r\n    }\r\n    levelObj[posLen].push(item);\r\n  });\r\n  const levelArr = Object.keys(levelObj).sort();\r\n  for (let i = 0; i < levelArr.length; i++) {\r\n    if (levelArr[i + 1]) {\r\n      levelObj[levelArr[i]].forEach(ii => {\r\n        for (let j = i + 1; j < levelArr.length; j++) {\r\n          levelObj[levelArr[j]].forEach((_i, index) => {\r\n            if (isPositionPrefix(ii, _i)) {\r\n              levelObj[levelArr[j]][index] = null;\r\n            }\r\n          });\r\n          levelObj[levelArr[j]] = levelObj[levelArr[j]].filter(p => p);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  let nArr = [];\r\n  levelArr.forEach(i => {\r\n    nArr = nArr.concat(levelObj[i]);\r\n  });\r\n  return nArr;\r\n}\r\n// console.log(filterParentPosition(\r\n//   ['0-2', '0-3-3', '0-10', '0-10-0', '0-0-1', '0-0', '0-1-1', '0-1']\r\n// ));\r\n\r\n\r\nfunction loopData(data, callback) {\r\n  const loop = (d, level = 0) => {\r\n    d.forEach((item, index) => {\r\n      const pos = `${level}-${index}`;\r\n      if (item.children) {\r\n        loop(item.children, pos);\r\n      }\r\n      callback(item, index, pos);\r\n    });\r\n  };\r\n  loop(data);\r\n}\r\n\r\nfunction spl(str) {\r\n  return str.split('-');\r\n}\r\nfunction splitLen(str) {\r\n  return str.split('-').length;\r\n}\r\n\r\nexport function getFilterExpandedKeys(data, expandedKeys) {\r\n  const expandedPosArr = [];\r\n  loopData(data, (item, index, pos) => {\r\n    if (expandedKeys.indexOf(item.key) > -1) {\r\n      expandedPosArr.push(pos);\r\n    }\r\n  });\r\n  const filterExpandedKeys = [];\r\n  loopData(data, (item, index, pos) => {\r\n    expandedPosArr.forEach(p => {\r\n      if ((splitLen(pos) < splitLen(p)\r\n        && p.indexOf(pos) === 0 || pos === p)\r\n        && filterExpandedKeys.indexOf(item.key) === -1) {\r\n        filterExpandedKeys.push(item.key);\r\n      }\r\n    });\r\n  });\r\n  return filterExpandedKeys;\r\n}\r\n\r\nfunction isSibling(pos, pos1) {\r\n  pos.pop();\r\n  pos1.pop();\r\n  return pos.join(',') === pos1.join(',');\r\n}\r\n\r\nexport function getRadioSelectKeys(data, selectedKeys, key) {\r\n  const res = [];\r\n  const pkObjArr = [];\r\n  const selPkObjArr = [];\r\n  loopData(data, (item, index, pos) => {\r\n    if (selectedKeys.indexOf(item.key) > -1) {\r\n      pkObjArr.push([pos, item.key]);\r\n    }\r\n    if (key && key === item.key) {\r\n      selPkObjArr.push(pos, item.key);\r\n    }\r\n  });\r\n  const lenObj = {};\r\n  const getPosKey = (pos, k) => {\r\n    const posLen = splitLen(pos);\r\n    if (!lenObj[posLen]) {\r\n      lenObj[posLen] = [[pos, k]];\r\n    } else {\r\n      lenObj[posLen].forEach((pkArr, i) => {\r\n        if (isSibling(spl(pkArr[0]), spl(pos))) {\r\n          // 后来覆盖前者\r\n          lenObj[posLen][i] = [pos, k];\r\n        } else if (spl(pkArr[0]) !== spl(pos)) {\r\n          lenObj[posLen].push([pos, k]);\r\n        }\r\n      });\r\n    }\r\n  };\r\n  pkObjArr.forEach((pk) => {\r\n    getPosKey(pk[0], pk[1]);\r\n  });\r\n  if (key) {\r\n    getPosKey(selPkObjArr[0], selPkObjArr[1]);\r\n  }\r\n\r\n  Object.keys(lenObj).forEach((item) => {\r\n    lenObj[item].forEach((i) => {\r\n      if (res.indexOf(i[1]) === -1) {\r\n        res.push(i[1]);\r\n      }\r\n    });\r\n  });\r\n  return res;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./examples/util.js"],"sourceRoot":""}